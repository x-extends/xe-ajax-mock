/*!
 * xe-ajax.js v3.1.2
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){var G=Array.isArray||function(an){return an?an.constructor===Array:false};function x(an){return typeof FormData!=="undefined"&&an instanceof FormData}function C(an){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(an.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function U(an){return an&&typeof an==="object"}function w(an){return typeof an==="function"}function e(){return location.origin||(location.protocol+"//"+location.host)}function v(){var an=location.pathname;var ao=Q(an,"/")+1;return e()+(ao===an.length?an:an.substring(0,ao))}function Q(ap,ao){if(w(ap.lastIndexOf)){return ap.lastIndexOf(ao)}else{for(var an=ap.length-1;an>=0;an--){if(ao===ap[an]){return an}}}return -1}function A(ap,aq,ao){for(var an in ap){if(ap.hasOwnProperty(an)){aq.call(ao,ap[an],an,ap)}}}function ab(ao,aq,ap){var an=[];A(ao,function(at,ar){if(U(at)){an=an.concat(ab(at,aq+"["+ar+"]",G(at)))}else{an.push(encodeURIComponent(aq+"["+(ap?"":ar)+"]")+"="+encodeURIComponent(at))}});return an}function h(an){var ao=[];A(an,function(aq,ap){if(aq!==undefined){if(U(aq)){ao=ao.concat(ab(aq,ap,G(aq)))}else{ao.push(encodeURIComponent(ap)+"="+encodeURIComponent(aq))}}});return ao.join("&").replace(/%20/g,"+")}var d=Object.assign||function(ar){for(var aq,ao=1,an=arguments.length;ao<an;ao++){aq=arguments[ao];for(var ap in aq){if(aq.hasOwnProperty(ap)){ar[ap]=aq[ap]}}}return ar};function l(ar,aq,ap){if(ar.forEach){ar.forEach(aq,ap)}else{for(var ao=0,an=ar.length||0;ao<an;ao++){aq.call(ap||b,ar[ao],ao,ar)}}}function ah(an){an.$context=an.$Promise=null}function ai(an){return String(an).toLowerCase()}function M(){this._state={};this.set=function(an,ao){this._state[ai(an)]=[ao]};this.get=function(an){var ao=ai(an);return this.has(ao)?this._state[ao].join(", "):null};this.append=function(an,ap){var ao=ai(an);if(this.has(ao)){return this._state[ao].push(ap)}else{this.set(ao,ap)}};this.has=function(an){return !!this._state[ai(an)]};this["delete"]=function(an){delete this._state[ai(an)]}}d(M.prototype,{forEach:function(ao,an){A(this._state,function(ar,ap,aq){ao.call(an,ar.join(", "),aq)})}});var n=[];function K(ap){for(var ao=0,an=n.length;ao<an;ao++){if(ap===n[ao][0]){return ao}}}function J(ao){if(ao.signal){var an=K(ao.signal);if(an===undefined){n.push([ao.signal,[ao]])}else{n[an][1].push(ao)}}}function R(){}function E(){this.signal=new R()}d(E.prototype,{abort:function(){var an=K(this.signal);if(an!==undefined){l(n[an][1],function(ao){setTimeout(function(){ao.abort()})});n.splice(an,1)}}});var am={request:[],response:[]};function S(an){return function(ao){if(an.indexOf(ao)===-1){an.push(ao)}}}function a(an){try{var ao=JSON.stringify(an.body)}catch(ap){ao=""}this.status=an.status;this.responseHeaders=an.headers;this.response=ao;this.responseText=ao}d(a.prototype,{getAllResponseHeaders:function(){var an="";var ap=this.responseHeaders;if(ap){for(var ao in ap){if(ap.hasOwnProperty(ao)){an+=ao+": "+ap[ao]+"\n"}}}return an}});function B(an){var ap=an.$Promise;var ao=ap.resolve(an,an.$context);l(am.request,function(aq){ao=ao.then(function(ar){return new ap(function(at){aq(ar,function(){at(ar)})},an.$context)}).catch(function(ar){console.error(ar)})});return ao}function y(ao,an){var aq=ao.$Promise;var ap=aq.resolve(an,ao.$context);l(am.response,function(ar){ap=ap.then(function(at){return new aq(function(au){ar(at,function(av){if(av&&av.constructor!==V){au(new V(ao,new a(av)))}else{au(at)}})},ao.$context)}).catch(function(at){console.error(at)})});return ap}var T={request:{use:S(am.request)},response:{use:S(am.response)}};T.request.use(function(ao,an){if(!x(ao.method==="GET"?ao.params:ao.body)){if(ao.method!=="GET"&&String(ao.bodyType).toLocaleUpperCase()==="JSON_DATA"){ao.setHeader("Content-Type","application/json; charset=utf-8")}else{ao.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(ao.crossOrigin){ao.setHeader("X-Requested-With","XMLHttpRequest")}an()});function al(an){d(this,{url:"",body:null,params:null,signal:null},an);this.ABORT_RESPONSE=undefined;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=C(this);if(this.jsonp){this.script=document.createElement("script")}else{this.xhr=w(this.getXMLHttpRequest)?this.getXMLHttpRequest(this):new XMLHttpRequest()}J(this)}d(al.prototype,{abort:function(an){this.xhr.abort(an)},setHeader:function(an,ao){this.headers[an]=ao},getHeader:function(){return this.headers[name]},deleteHeader:function(an){delete this.headers[an]},clearHeader:function(){this.headers={}},getUrl:function(){var an=this.url;var ao="";if(an){if(w(this.transformParams)){this.params=this.transformParams(this.params||{},this)}if(this.params&&!x(this.params)){ao=w(this.paramsSerializer)?this.paramsSerializer(this.params,this):h(this.params)
}if(ao){an+=(an.indexOf("?")===-1?"?":"&")+ao}if(/\w+:\/{2}.*/.test(an)){return an}if(an.indexOf("/")===0){return e()+an}return this.baseURL.replace(/\/$/,"")+"/"+an}return an},getBody:function(){var an=this;var ao=an.$Promise;return new ao(function(ar,aq){var ap=null;if(an.body&&an.method!=="GET"){try{if(w(an.transformBody)){an.body=an.transformBody(an.body||{},an)||an.body}if(w(an.stringifyBody)){ap=an.stringifyBody(an.body,an)||null}else{if(x(an.body)){ap=an.body}else{if(String(an.bodyType).toLocaleUpperCase()==="FORM_DATA"){ap=h(an.body)}else{ap=JSON.stringify(an.body)}}}}catch(at){console.error(at)}}ar(ap)},an.$context)}});function r(ao,an){this.locked=false;this._xhr=ao;this._request=an}d(r.prototype,{_getBody:function(){var ao=this;var aq=this._xhr;var an=this._request;var ap=an.$Promise;return new ap(function(au,at){var ar={responseText:"",response:aq};if(aq&&aq.response!==undefined&&aq.status!==undefined){if(aq.responseText){ar.responseText=aq.responseText;try{ar.response=JSON.parse(aq.responseText)}catch(av){ar.response=null}}else{ar.response=aq.response;ar.responseText=JSON.stringify(aq.response)}}else{ar.responseText=JSON.stringify(ar.response)}if(ao.locked){at(new TypeError("body stream already read"))}else{ao.locked=true;au(ar)}},an.$context)}});function V(ao,aq){var an=this;this.body=new r(aq,ao);this.bodyUsed=false;this.url=ao.url;this.headers=new M();this.status=0;this.statusText="";this.ok=false;this.redirected=false;this.type="basic";this.json=function(){return this.body._getBody().then(function(ar){an.bodyUsed=true;return ar.response})};this.text=function(){return this.body._getBody().then(function(ar){an.bodyUsed=true;return ar.responseText})};if(aq&&aq.response!==undefined&&aq.status!==undefined){this.status=aq.status;this.redirected=this.status===302;this.ok=ao.getPromiseStatus(this);if(this.status===1223||this.status===204){this.statusText="No Content"}else{if(this.status===304){this.statusText="Not Modified"}else{this.statusText=(aq.statusText||this.statusText).trim()}}if(aq.getAllResponseHeaders){var ap=aq.getAllResponseHeaders().trim();if(ap){l(ap.split("\n"),function(at){var ar=at.indexOf(":");this.headers.set(at.slice(0,ar).trim(),at.slice(ar+1).trim())},this)}}}}var b=typeof window==="undefined"?this:window;var aa={method:"GET",baseURL:v(),async:true,credentials:"same-origin",bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getPromiseStatus:function(an){return an.status>=200&&an.status<300}};function c(an){var ao=d({$Promise:Promise},aa,{headers:d({},aa.headers)},an);var ap=ao.$Promise;return new ap(function(ar,aq){return(ao.jsonp?k:Y)(new al(ao),ar,aq)},ao.$context)}function D(an,aq,ap,ao){y(an,new V(an,aq)).then(function(ar){ap(ar)})}function Y(an,ap,ao){var aq=an.xhr;B(an).then(function(){aq.open(an.method,an.getUrl(),an.async!==false);if(an.timeout&&!isNaN(an.timeout)){aq.timeout=an.timeout}A(an.headers,function(at,ar){aq.setRequestHeader(ar,at)});aq.onreadystatechange=function(){if(aq.readyState===4){D(an,aq,ap,ao)}};if(an.credentials==="include"){aq.withCredentials=true}else{if(an.credentials==="omit"){aq.withCredentials=false}}an.getBody().then(function(ar){aq.send(ar)}).catch(function(){aq.send()})})}var j=0;function k(ap,ar,aq){var an=ap.script;var ao=ap.getUrl();if(!ap.jsonpCallback){ap.jsonpCallback="_xeajax_jsonp"+(++j)}b[ap.jsonpCallback]=function(at){o(ap,{status:200,response:at},ar,aq)};an.type="text/javascript";an.src=ao+(ao.indexOf("?")===-1?"?":"&")+ap.jsonp+"="+ap.jsonpCallback;an.onerror=function(at){o(ap,{status:500,response:null},ar,aq)};if(w(ap.sendJSONP)){ap.sendJSONP(an,ap,ar,aq)}else{document.body.appendChild(an)}}function o(ao,ar,aq,ap){var an=new V(ao,ar);delete b[ao.jsonpCallback];if(w(ao.sendEndJSONP)){ao.sendEndJSONP(ao.script,ao)}else{document.body.removeChild(ao.script)}an.json().then(function(at){(an.ok?aq:ap)(at)}).catch(function(at){ap(at)})}var m=function m(an){d(aa,an)};function af(aq,ap,an){var ao=d({method:aq,$context:c.$context,$Promise:c.$Promise||Promise},ap,an);ah(c);return ao}function ad(an){return function(){return O(an.apply(this,arguments))}}function ak(an){return function(){var ao=an.apply(this,arguments);var ap=ao.$Promise;return O(ao).then(function(aq){return new ap(function(at,ar){aq.json().then(function(au){(aq.ok?at:ar)(au)}).catch(function(au){ar(au)})},this)})}}var O=c;function s(ao){var ap=c.$Promise||Promise;var an=c.$context;ah(c);return ap.all(ao.map(function(aq){if(aq instanceof ap){return aq}else{if(aq&&U(aq)){return O(d({$context:an,$Promise:ap},aq))}}return aq}),an)}function X(an,ap,ao){return af("GET",U(an)?{}:{url:an,params:ap},ao)}function F(ao,an,ap){return af("POST",U(ao)?{}:{url:ao,body:an},ap)}function I(ao,an,ap){return af("PUT",U(ao)?{}:{url:ao,body:an},ap)}function N(ao,an,ap){return af("PATCH",U(ao)?{}:{url:ao,body:an},ap)}function p(ao,an,ap){return af("DELETE",U(ao)?{}:{url:ao,body:an},ap)}function q(an,ap,ao){return c(af("GET",{url:an,params:ap,jsonp:"callback"},ao))}var u=ad(X);
var H=ad(F);var f=ad(I);var t=ad(N);var i=ad(p);var W=ak(X);var Z=ak(F);var g=ak(I);var z=ak(N);var ae=ak(p);var L=E;var ag="3.1.2";var P={doAll:s,ajax:O,fetchGet:u,getJSON:W,fetchPost:H,postJSON:Z,fetchPut:f,putJSON:g,fetchPatch:t,patchJSON:z,fetchDelete:i,deleteJSON:ae,jsonp:q,setup:m,serialize:h,interceptors:T,version:ag};function aj(an){A(an,function(ap,ao){c[ao]=w(ap)?function(){var aq=ap.apply(c.$context,arguments);ah(c);return aq}:ap})}function ac(an){an.install(c)}aj(P);c.use=ac;c.mixin=aj;c.AjaxController=L;return c}));