/*!
 * xe-ajax.js v3.1.1
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){var F=Array.isArray||function(am){return am?am.constructor===Array:false};function w(am){return typeof FormData!=="undefined"&&am instanceof FormData}function B(am){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(am.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function T(am){return am&&typeof am==="object"}function v(am){return typeof am==="function"}function u(){var am=location.pathname;var an=P(am,"/")+1;return location.origin+(an===am.length?am:am.substring(0,an))}function P(ao,an){if(v(ao.lastIndexOf)){return ao.lastIndexOf(an)}else{for(var am=ao.length-1;am>=0;am--){if(an===ao[am]){return am}}}return -1}function z(ao,ap,an){for(var am in ao){if(ao.hasOwnProperty(am)){ap.call(an,ao[am],am,ao)}}}function aa(an,ap,ao){var am=[];z(an,function(ar,aq){if(T(ar)){am=am.concat(aa(ar,ap+"["+aq+"]",F(ar)))}else{am.push(encodeURIComponent(ap+"["+(ao?"":aq)+"]")+"="+encodeURIComponent(ar))}});return am}function g(am){var an=[];z(am,function(ap,ao){if(ap!==undefined){if(T(ap)){an=an.concat(aa(ap,ao,F(ap)))}else{an.push(encodeURIComponent(ao)+"="+encodeURIComponent(ap))}}});return an.join("&").replace(/%20/g,"+")}var d=Object.assign||function(aq){for(var ap,an=1,am=arguments.length;an<am;an++){ap=arguments[an];for(var ao in ap){if(ap.hasOwnProperty(ao)){aq[ao]=ap[ao]}}}return aq};function k(aq,ap,ao){if(aq.forEach){aq.forEach(ap,ao)}else{for(var an=0,am=aq.length||0;an<am;an++){ap.call(ao||b,aq[an],an,aq)}}}function ag(am){am.$context=am.$Promise=null}function ah(am){return String(am).toLowerCase()}function L(){this._state={};this.set=function(am,an){this._state[ah(am)]=[an]};this.get=function(am){var an=ah(am);return this.has(an)?this._state[an].join(", "):null};this.append=function(am,ao){var an=ah(am);if(this.has(an)){return this._state[an].push(ao)}else{this.set(an,ao)}};this.has=function(am){return !!this._state[ah(am)]};this["delete"]=function(am){delete this._state[ah(am)]}}d(L.prototype,{forEach:function(an,am){z(this._state,function(aq,ao,ap){an.call(am,aq.join(", "),ap)})}});var m=[];function J(ao){for(var an=0,am=m.length;an<am;an++){if(ao===m[an][0]){return an}}}function I(an){if(an.signal){var am=J(an.signal);if(am===undefined){m.push([an.signal,[an]])}else{m[am][1].push(an)}}}function Q(){}function D(){this.signal=new Q()}d(D.prototype,{abort:function(){var am=J(this.signal);if(am!==undefined){k(m[am][1],function(an){setTimeout(function(){an.abort()})});m.splice(am,1)}}});const al={request:[],response:[]};function R(am){return function(an){if(am.indexOf(an)===-1){am.push(an)}}}function a(am){try{var an=JSON.stringify(am.body)}catch(ao){an=""}this.status=am.status;this.responseHeaders=am.headers;this.response=an;this.responseText=an}d(a.prototype,{getAllResponseHeaders:function(){var am="";var ao=this.responseHeaders;if(ao){for(var an in ao){if(ao.hasOwnProperty(an)){am+=an+": "+ao[an]+"\n"}}}return am}});function A(am){var ao=am.$Promise;var an=ao.resolve(am,am.$context);k(al.request,function(ap){an=an.then(function(aq){return new ao(function(ar){ap(aq,function(){ar(aq)})},am.$context)}).catch(function(aq){console.error(aq)})});return an}function x(an,am){var ap=an.$Promise;var ao=ap.resolve(am,an.$context);k(al.response,function(aq){ao=ao.then(function(ar){return new ap(function(at){aq(ar,function(au){if(au&&au.constructor!==U){at(new U(an,new a(au)))}else{at(ar)}})},an.$context)}).catch(function(ar){console.error(ar)})});return ao}var S={request:{use:R(al.request)},response:{use:R(al.response)}};S.request.use(function(an,am){if(!w(an.method==="GET"?an.params:an.body)){if(an.method!=="GET"&&String(an.bodyType).toLocaleUpperCase()==="JSON_DATA"){an.setHeader("Content-Type","application/json; charset=utf-8")}else{an.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(an.crossOrigin){an.setHeader("X-Requested-With","XMLHttpRequest")}am()});function ak(am){d(this,{url:"",body:null,params:null,signal:null},am);this.ABORT_RESPONSE=undefined;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=B(this);if(this.jsonp){this.script=document.createElement("script")}else{this.xhr=v(this.getXMLHttpRequest)?this.getXMLHttpRequest(this):new XMLHttpRequest()}I(this)}d(ak.prototype,{abort:function(am){this.xhr.abort(am)},setHeader:function(am,an){this.headers[am]=an},getHeader:function(){return this.headers[name]},deleteHeader:function(am){delete this.headers[am]},clearHeader:function(){this.headers={}},getUrl:function(){var am=this.url;var an="";if(am){if(v(this.transformParams)){this.params=this.transformParams(this.params||{},this)}if(this.params&&!w(this.params)){an=v(this.paramsSerializer)?this.paramsSerializer(this.params,this):g(this.params)}if(an){am+=(am.indexOf("?")===-1?"?":"&")+an}if(/\w+:\/{2}.*/.test(am)){return am
}if(am.indexOf("/")===0){return location.origin+am}return this.baseURL.replace(/\/$/,"")+"/"+am}return am},getBody:function(){var am=this;var an=am.$Promise;return new an(function(aq,ap){var ao=null;if(am.body&&am.method!=="GET"){try{if(v(am.transformBody)){am.body=am.transformBody(am.body||{},am)||am.body}if(v(am.stringifyBody)){ao=am.stringifyBody(am.body,am)||null}else{if(w(am.body)){ao=am.body}else{if(String(am.bodyType).toLocaleUpperCase()==="FORM_DATA"){ao=g(am.body)}else{ao=JSON.stringify(am.body)}}}}catch(ar){console.error(ar)}}aq(ao)},am.$context)}});function q(an,am){this.locked=false;this._xhr=an;this._request=am}d(q.prototype,{_getBody:function(){var an=this;var ap=this._xhr;var am=this._request;var ao=am.$Promise;return new ao(function(at,ar){var aq={responseText:"",response:ap};if(ap&&ap.response!==undefined&&ap.status!==undefined){if(ap.responseText){aq.responseText=ap.responseText;try{aq.response=JSON.parse(ap.responseText)}catch(au){aq.response=null}}else{aq.response=ap.response;aq.responseText=JSON.stringify(ap.response)}}else{aq.responseText=JSON.stringify(aq.response)}if(an.locked){ar(new TypeError("body stream already read"))}else{an.locked=true;at(aq)}},am.$context)}});function U(an,ap){var am=this;this.body=new q(ap,an);this.bodyUsed=false;this.url=an.url;this.headers=new L();this.status=0;this.statusText="";this.ok=false;this.redirected=false;this.type="basic";this.json=function(){return this.body._getBody().then(function(aq){am.bodyUsed=true;return aq.response})};this.text=function(){return this.body._getBody().then(function(aq){am.bodyUsed=true;return aq.responseText})};if(ap&&ap.response!==undefined&&ap.status!==undefined){this.status=ap.status;this.redirected=this.status===302;this.ok=an.getPromiseStatus(this);if(this.status===1223||this.status===204){this.statusText="No Content"}else{if(this.status===304){this.statusText="Not Modified"}else{this.statusText=(ap.statusText||this.statusText).trim()}}if(ap.getAllResponseHeaders){var ao=ap.getAllResponseHeaders().trim();if(ao){k(ao.split("\n"),function(ar){var aq=ar.indexOf(":");this.headers.set(ar.slice(0,aq).trim(),ar.slice(aq+1).trim())},this)}}}}var b=typeof window==="undefined"?this:window;var Z={method:"GET",baseURL:u(),async:true,credentials:"same-origin",bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getPromiseStatus:function(am){return am.status>=200&&am.status<300}};function c(am){var an=d({$Promise:Promise},Z,{headers:d({},Z.headers)},am);var ao=an.$Promise;return new ao(function(aq,ap){return(an.jsonp?j:X)(new ak(an),aq,ap)},an.$context)}function C(am,ap,ao,an){x(am,new U(am,ap)).then(function(aq){ao(aq)})}function X(am,ao,an){var ap=am.xhr;A(am).then(function(){ap.open(am.method,am.getUrl(),am.async!==false);if(am.timeout&&!isNaN(am.timeout)){ap.timeout=am.timeout}z(am.headers,function(ar,aq){ap.setRequestHeader(aq,ar)});ap.onreadystatechange=function(){if(ap.readyState===4){C(am,ap,ao,an)}};if(am.credentials==="include"){ap.withCredentials=true}else{if(am.credentials==="omit"){ap.withCredentials=false}}am.getBody().then(function(aq){ap.send(aq)}).catch(function(){ap.send()})})}var i=0;function j(ao,aq,ap){var am=ao.script;var an=ao.getUrl();if(!ao.jsonpCallback){ao.jsonpCallback="_xeajax_jsonp"+(++i)}b[ao.jsonpCallback]=function(ar){n(ao,{status:200,response:ar},aq,ap)};am.type="text/javascript";am.src=an+(an.indexOf("?")===-1?"?":"&")+ao.jsonp+"="+ao.jsonpCallback;am.onerror=function(ar){n(ao,{status:500,response:null},aq,ap)};if(v(ao.sendJSONP)){ao.sendJSONP(am,ao,aq,ap)}else{document.body.appendChild(am)}}function n(an,aq,ap,ao){var am=new U(an,aq);delete b[an.jsonpCallback];if(v(an.sendEndJSONP)){an.sendEndJSONP(an.script,an)}else{document.body.removeChild(an.script)}am.json().then(function(ar){(am.ok?ap:ao)(ar)}).catch(function(ar){ao(ar)})}var l=function l(am){d(Z,am)};function ae(ap,ao,am){var an=d({method:ap,$context:c.$context,$Promise:c.$Promise||Promise},ao,am);ag(c);return an}function ac(am){return function(){return N(am.apply(this,arguments))}}function aj(am){return function(){var an=am.apply(this,arguments);var ao=an.$Promise;return N(an).then(function(ap){return new ao(function(ar,aq){ap.json().then(function(at){(ap.ok?ar:aq)(at)}).catch(function(at){aq(at)})},this)})}}var N=c;function r(an){var ao=c.$Promise||Promise;var am=c.$context;ag(c);return ao.all(an.map(function(ap){if(ap instanceof ao){return ap}else{if(ap&&T(ap)){return N(d({$context:am,$Promise:ao},ap))}}return ap}),am)}function W(am,ao,an){return ae("GET",T(am)?{}:{url:am,params:ao},an)}function E(an,am,ao){return ae("POST",T(an)?{}:{url:an,body:am},ao)}function H(an,am,ao){return ae("PUT",T(an)?{}:{url:an,body:am},ao)}function M(an,am,ao){return ae("PATCH",T(an)?{}:{url:an,body:am},ao)}function o(an,am,ao){return ae("DELETE",T(an)?{}:{url:an,body:am},ao)}function p(am,ao,an){return c(ae("GET",{url:am,params:ao,jsonp:"callback"},an))}var t=ac(W);var G=ac(E);var e=ac(H);var s=ac(M);var h=ac(o);var V=aj(W);var Y=aj(E);
var f=aj(H);var y=aj(M);var ad=aj(o);var K=D;var af="3.1.1";var O={doAll:r,ajax:N,fetchGet:t,getJSON:V,fetchPost:G,postJSON:Y,fetchPut:e,putJSON:f,fetchPatch:s,patchJSON:y,fetchDelete:h,deleteJSON:ad,jsonp:p,setup:l,serialize:g,interceptors:S,AjaxController:K,version:af};function ai(am){z(am,function(ao,an){c[an]=v(ao)?function(){var ap=ao.apply(c.$context,arguments);ag(c);return ap}:ao})}function ab(am){am.install(c)}ai(O);c.use=ab;c.mixin=ai;return c}));