/*!
 * xe-ajax.js v3.0.13
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){var J=window.Promise;var C=Array.isArray||function(ag){return ag?ag.constructor===Array:false};function v(ag){return typeof FormData!=="undefined"&&ag instanceof FormData}function z(ag){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(ag.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function Q(ag){return ag&&typeof ag==="object"}function u(ag){return typeof ag==="function"}function t(){var ag=location.pathname;var ah=L(ag,"/")+1;return location.origin+(ah===ag.length?ag:ag.substring(0,ah))}function L(ai,ah){if(u(ai.lastIndexOf)){return ai.lastIndexOf(ah)}else{for(var ag=ai.length-1;ag>=0;ag--){if(ah===ai[ag]){return ag}}}return -1}function M(ai,aj,ah){for(var ag in ai){if(ai.hasOwnProperty(ag)){aj.call(ah,ai[ag],ag,ai)}}}function W(ah,aj,ai){var ag=[];M(ah,function(al,ak){if(Q(al)){ag=ag.concat(W(al,aj+"["+ak+"]",C(al)))}else{ag.push(encodeURIComponent(aj+"["+(ai?"":ak)+"]")+"="+encodeURIComponent(al))}});return ag}function g(ag){var ah=[];M(ag,function(aj,ai){if(aj!==undefined){if(Q(aj)){ah=ah.concat(W(aj,ai,C(aj)))}else{ah.push(encodeURIComponent(ai)+"="+encodeURIComponent(aj))}}});return ah.join("&").replace(/%20/g,"+")}var d=Object.assign||function(ak){for(var aj,ah=1,ag=arguments.length;ah<ag;ah++){aj=arguments[ah];for(var ai in aj){if(aj.hasOwnProperty(ai)){ak[ai]=aj[ai]}}}return ak};function k(ak,aj,ai){if(ak.forEach){ak.forEach(aj,ai)}else{for(var ah=0,ag=ak.length||0;ah<ag;ah++){aj.call(ai||b,ak[ah],ah,ak)}}}function aa(ag){return String(ag).toLowerCase()}function H(){this._state={};this.set=function(ag,ah){this._state[aa(ag)]=[ah]};this.get=function(ag){var ah=aa(ag);return this.has(ah)?this._state[ah].join(", "):null};this.append=function(ag,ai){var ah=aa(ag);if(this.has(ah)){return this._state[ah].push(ai)}else{this.set(ah,ai)}};this.has=function(ag){return !!this._state[aa(ag)]};this["delete"]=function(ag){delete this._state[aa(ag)]}}d(H.prototype,{forEach:function(ah,ag){M(this._state,function(ak,ai,aj){ah.call(ag,ak.join(", "),aj)})}});var m=[];function F(ai){for(var ah=0,ag=m.length;ah<ag;ah++){if(ai===m[ah][0]){return ah}}}function E(ah){if(ah.signal){var ag=F(ah.signal);if(ag===undefined){m.push([ah.signal,[ah]])}else{m[ag][1].push(ah)}}}function N(){}function B(){this.signal=new N()}d(B.prototype,{abort:function(){var ag=F(this.signal);if(ag!==undefined){k(m[ag][1],function(ah){setTimeout(function(){ah.abort()})});m.splice(ag,1)}}});const af={request:[],response:[]};function O(ag){return function(ah){if(ag.indexOf(ah)===-1){ag.push(ah)}}}function a(ag){try{var ah=JSON.stringify(ag.body)}catch(ai){ah=""}this.status=ag.status;this.responseHeaders=ag.headers;this.response=ah;this.responseText=ah}d(a.prototype,{getAllResponseHeaders:function(){var ag="";var ai=this.responseHeaders;if(ai){for(var ah in ai){if(ai.hasOwnProperty(ah)){ag+=ah+": "+ai[ah]+"\n"}}}return ag}});function y(ag){var ah=J.resolve(ag,ag.context);k(af.request,function(ai){ah=ah.then(function(aj){return new J(function(ak){ai(aj,function(){ak(aj)})},ag.context)}).catch(function(aj){console.error(aj)})});return ah}function w(ah,ag){var ai=J.resolve(ag,ah.context);k(af.response,function(aj){ai=ai.then(function(ak){return new J(function(al){aj(ak,function(am){if(am&&am.constructor!==R){al(new R(ah,new a(am)))}else{al(ak)}})},ah.context)}).catch(function(ak){console.error(ak)})});return ai}var P={request:{use:O(af.request)},response:{use:O(af.response)}};P.request.use(function(ah,ag){if(!v(ah.method==="GET"?ah.params:ah.body)){if(ah.method!=="GET"&&String(ah.bodyType).toLocaleUpperCase()==="JSON_DATA"){ah.setHeader("Content-Type","application/json; charset=utf-8")}else{ah.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(ah.crossOrigin){ah.setHeader("X-Requested-With","XMLHttpRequest")}ag()});function ad(ag){d(this,{url:"",body:null,params:null,signal:null},ag);this.ABORT_RESPONSE=undefined;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=z(this);if(ag&&ag.jsonp){this.script=document.createElement("script")}else{this.xhr=ag.getXMLHttpRequest(this)}E(this)}d(ad.prototype,{abort:function(ag){this.xhr.abort(ag)},setHeader:function(ag,ah){this.headers[ag]=ah},getHeader:function(){return this.headers[name]},deleteHeader:function(ag){delete this.headers[ag]},clearHeader:function(){this.headers={}},getUrl:function(){var ag=this.url;var ah="";if(ag){if(u(this.transformParams)){this.params=this.transformParams(this.params||{},this)}if(this.params&&!v(this.params)){ah=u(this.paramsSerializer)?this.paramsSerializer(this.params,this):g(this.params)}if(ah){ag+=(ag.indexOf("?")===-1?"?":"&")+ah}if(/\w+:\/{2}.*/.test(ag)){return ag}return this.baseURL.replace(/\/$/,"")+"/"+ag.replace(/^\//,"")}return ag},getBody:function(){var ag=this;
return new J(function(aj,ai){var ah=null;if(ag.body&&ag.method!=="GET"){try{if(u(ag.transformBody)){ag.body=ag.transformBody(ag.body||{},ag)||ag.body}if(u(ag.stringifyBody)){ah=ag.stringifyBody(ag.body,ag)||null}else{if(v(ag.body)){ah=ag.body}else{if(String(ag.bodyType).toLocaleUpperCase()==="FORM_DATA"){ah=g(ag.body)}else{ah=JSON.stringify(ag.body)}}}}catch(ak){console.error(ak)}}aj(ah)},ag.context)}});function p(ah,ag){this.locked=false;this._xhr=ah;this._request=ag}d(p.prototype,{_getBody:function(){var ah=this;var ai=this._xhr;var ag=this._request;return new J(function(al,ak){var aj={responseText:"",response:ai};if(ai&&ai.response!==undefined&&ai.status!==undefined){if(ai.responseText){aj.responseText=ai.responseText;try{aj.response=JSON.parse(ai.responseText)}catch(am){aj.response=null}}else{aj.response=ai.response;aj.responseText=JSON.stringify(ai.response)}}else{aj.responseText=JSON.stringify(aj.response)}if(ah.locked){ak(new TypeError("body stream already read"))}else{ah.locked=true;al(aj)}},ag.context)}});function R(ah,aj){var ag=this;this.body=new p(aj,ah);this.bodyUsed=false;this.url=ah.url;this.headers=new H();this.status=0;this.statusText="";this.ok=false;this.redirected=false;this.type="basic";this.json=function(){return this.body._getBody().then(function(ak){ag.bodyUsed=true;return ak.response})};this.text=function(){return this.body._getBody().then(function(ak){ag.bodyUsed=true;return ak.responseText})};if(aj&&aj.response!==undefined&&aj.status!==undefined){this.status=aj.status;this.redirected=this.status===302;this.ok=ah.getPromiseStatus(this);if(this.status===1223||this.status===204){this.statusText="No Content"}else{if(this.status===304){this.statusText="Not Modified"}else{this.statusText=(aj.statusText||this.statusText).trim()}}if(aj.getAllResponseHeaders){var ai=aj.getAllResponseHeaders().trim();if(ai){k(ai.split("\n"),function(al){var ak=al.indexOf(":");this.headers.set(al.slice(0,ak).trim(),al.slice(ak+1).trim())},this)}}}}var b=typeof window==="undefined"?this:window;var V={method:"GET",baseURL:t(),async:true,credentials:"same-origin",bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getXMLHttpRequest:function(){return new XMLHttpRequest()},getPromiseStatus:function(ag){return ag.status>=200&&ag.status<300}};function c(ag){var ah={context:c.context};c.context=null;d(ah,V,{headers:d({},V.headers)},ag);return new J(function(aj,ai){return(ag&&ag.jsonp?j:T)(new ad(ah),aj,ai)},ah.context)}function A(ag,aj,ai,ah){w(ag,new R(ag,aj)).then(function(ak){ai(ak)})}function T(ag,ai,ah){var aj=ag.xhr;y(ag).then(function(){aj.open(ag.method,ag.getUrl(),ag.async!==false);if(ag.timeout&&!isNaN(ag.timeout)){aj.timeout=ag.timeout}M(ag.headers,function(al,ak){aj.setRequestHeader(ak,al)});aj.onreadystatechange=function(){if(aj.readyState===4){A(ag,aj,ai,ah)}};if(ag.credentials==="include"){aj.withCredentials=true}else{if(ag.credentials==="omit"){aj.withCredentials=false}}ag.getBody().then(function(ak){aj.send(ak)}).catch(function(){aj.send()})})}var i=0;function j(ai,ak,aj){var ag=ai.script;var ah=ai.getUrl();if(!ai.jsonpCallback){ai.jsonpCallback="_xeajax_jsonp"+(++i)}b[ai.jsonpCallback]=function(al){n(ai,{status:200,response:al},ak,aj)};ag.type="text/javascript";ag.src=ah+(ah.indexOf("?")===-1?"?":"&")+ai.jsonp+"="+ai.jsonpCallback;ag.onerror=function(al){n(ai,{status:500,response:null},ak,aj)};if(u(ai.sendJSONP)){ai.sendJSONP(ag,ai,ak,aj)}else{document.body.appendChild(ag)}}function n(ah,ak,aj,ai){var ag=new R(ah,ak);delete b[ah.jsonpCallback];if(u(ah.sendEndJSONP)){ah.sendEndJSONP(ah.script,ah)}else{document.body.removeChild(ah.script)}ag.json().then(function(al){(ag.ok?aj:ai)(al)}).catch(function(al){ai(al)})}var l=function l(ag){d(V,ag)};function ae(ai,ah,ag){return c(d({method:ai},ah,ag))}function ac(ag){return function(){return ag.apply(this,arguments).then(function(ah){return new J(function(aj,ai){ah.json().then(function(ak){(ah.ok?aj:ai)(ak)}).catch(function(ak){ai(ak)})},this)})}}var I=c;function q(ag){return J.all(ag.map(function(ah){if(ah instanceof J){return ah}else{if(ah&&Q(ah)){return I(ah)}}return ah}),arguments[1])}function s(ag,ai,ah){return ae("GET",Q(ag)?{}:{url:ag,params:ai},ah)}function D(ah,ag,ai){return ae("POST",Q(ah)?{}:{url:ah,body:ag},ai)}function e(ah,ag,ai){return ae("PUT",Q(ah)?{}:{url:ah,body:ag},ai)}function r(ah,ag,ai){return ae("PATCH",Q(ah)?{}:{url:ah,body:ag},ai)}function h(ah,ag,ai){return ae("DELETE",Q(ah)?{}:{url:ah,body:ag},ai)}function o(ag,ai,ah){return ae("GET",{url:ag,params:ai,jsonp:"callback"},ah)}var S=ac(s);var U=ac(D);var f=ac(e);var x=ac(r);var Y=ac(h);var G=B;var Z="3.0.13";var K={doAll:q,ajax:I,fetchGet:s,getJSON:S,fetchPost:D,postJSON:U,fetchPut:e,putJSON:f,fetchPatch:r,patchJSON:x,fetchDelete:h,deleteJSON:Y,jsonp:o,setup:l,serialize:g,interceptors:P,AjaxController:G,version:Z};function ab(ag){return d(c,ag)}function X(ag){ag.install(c)}ab(K);c.use=X;c.mixin=ab;c.$p=function(ag){J=ag};return c}));