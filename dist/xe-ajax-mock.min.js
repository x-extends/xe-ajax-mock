/**
 * xe-ajax-mock.js v1.6.9
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 * @preserve
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.XEAjaxMock=e()}(this,function(){"use strict";function t(t){return!!t&&t.constructor===Date}function e(t){return"object"==typeof t}function n(t){return"function"==typeof t}function r(t){return"string"==typeof t}function o(t,e){return t>=e?t:(t=t||0)+Math.round(Math.random()*((e||9)-t))}function s(e,n){if(e){if(t(e))return e;if(!isNaN(e))return new Date(e);if(r(e)){n=n||"yyyy-MM-dd HH:mm:ss.SSS";var o=[];return a(C,function(t){for(var r,s,i=0,a=t.rules,u=a.length;i<u;i++){if(r=a[i],(s=n.indexOf(r[0]))>-1){o.push(parseFloat(e.substring(s,s+r[1])||0)+(t.offset||0));break}i===u-1&&o.push(0)}}),new Date(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}}return"Invalid Date"}function i(e,n){if(e=s(e),t(e)){var r=n||"yyyy-MM-dd HH:mm:ss",o=["日","一","二","三","四","五","六"],i={"q+":Math.floor((e.getMonth()+3)/3),"M+":e.getMonth()+1,"E+":e.getDay(),"d+":e.getDate(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),S:e.getMilliseconds()};return/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(""+e.getFullYear()).substr(4-RegExp.$1.length))),a(c(i),function(t){if(new RegExp("("+t+")").test(r)){var e=""+i[t];r=r.replace(RegExp.$1,"q+"===t||"E+"===t?o[e]:1===RegExp.$1.length?e:("00"+e).substr(e.length))}}),r}return e}function a(t,e,n){if(t.forEach)return t.forEach(e,n);for(var r=0,o=t.length||0;r<o;r++)e.call(n||global,t[r],r,t)}function u(t,e,n){for(var r in t)t.hasOwnProperty(r)&&e.call(n||this,t[r],r,t)}function c(t){var e=[];if(t){if(Object.keys)return Object.keys(t);u(t,function(t,n){e.push(n)})}return e}function h(t){for(var e=[],n=function(t){if(Object.values)return t?Object.values(t):[];var e=[];return a(c(t),function(n){e.push(t[n])}),e}(t),r=n.length-1;r>=0;r--){var s=r>0?o(0,r):0;e.push(n[s]),n.splice(s,1)}return e}function f(t,e){var n=h(t);return 1===arguments.length?n[0]:(e<n.length&&(n.length=e||0),n)}function p(){return location.origin||location.protocol+"//"+location.host}function l(t){var e=String(t).match(/(\d+)-(\d+)/);return e&&3===e.length?o(parseInt(e[1]),parseInt(e[2])):isNaN(t)?0:Number(t)}function d(t,e){var n=t.replace(/[\r\n\t]/g," ").replace(/{{\s*(.*?)\s*}}/g,function(t,e){return function(t){return N.contEnd+t+N.contStart}(N.cStart+e+N.cEnd)});try{return n="var "+N.tStart+";with(opts){"+N.contStart+n+N.contEnd+"};"+N.tEnd,new Function("opts",n.replace(N.simplifyRegExp,""))(e)}catch(t){console.error(t)}return t}function g(t,n){var r=null;if(r=m(t,new v({},n)),e(r)){var o=c(r);1===o.length&&"!return"===o[0]&&(r=r[o[0]])}return r}function m(t,n){if(t){if(A(t))return y(t,n);if(e(t))return function(t,e){var n={};return u(t,function(t,r){var o=r.match(D),s=null;if(o&&4===o.length){r=o[1];var i="random"===o[2].toLowerCase();if("array"===o[2].toLowerCase()||i){var a=l(d(o[3],e));if(A(t))t.length>a?(s=y(i?f(t,a):t.slice(0,a),e),i&&1===s.length&&(s=s[0])):s=y(t,e);else{s=[];for(var u=0;u<a;u++){var c=new v({$parent:e,$obj:s,$value:null,$size:a,$index:u},e.$fns);s.push(m(t,c))}}}}else s=m(t,e),(o=r.match(/(.+)\|(number|boolean)$/))&&3===o.length&&(r=o[1],"number"===o[2].toLowerCase()?s=parseFloat(s):"boolean"===o[2].toLowerCase()&&(s="0"!==s&&Boolean(s)));n[r]=s}),n}(t,n);if(r(t))return d(t,n)}return t}function y(t,e){var n=[];return a(t,function(r,o){var s=new v({$parent:e,$obj:t,$value:r,$size:t.length,$index:o},e.$fns);n.push(m(r,s))}),n}function v(t,e){this.$fns=e,P(this,e,t)}function b(t){return P(v.prototype,t)}function E(t,e){var n=e._request,r=j(n);return r?(r.time=l(r.options.timeout),r.getMockResponse(n).then(function(t){return r.outMockLog(n,t),t})):fetch(t,e)}function _(){this._mock=null,this._xhr=null}function w(t){t.script.parentNode===document.body&&document.body.removeChild(t.script),delete U[t.jsonpCallback]}function x(t,e,n){w(t),n(e)}function S(t,e){w(t),e(new TypeError("JSONP request failed"))}function T(t,e){return new Promise(function(n,r){var o=j(e);if(U[e.jsonpCallback]=function(t){x(e,{status:200,body:t},n)},o)return o.time=l(o.options.timeout),o.getMockResponse(o,e).then(function(t){t.status<200||t.status>=300?S(e,r):x(e,t.body,n),o.outMockLog(e,t)});var s=e.getUrl();t.type="text/javascript",t.src=s+(-1===s.indexOf("?")?"?":"&")+e.jsonp+"="+e.jsonpCallback,t.onerror=function(){S(e,r)},e.timeout&&setTimeout(function(){S(e,r)},e.timeout),document.body.appendChild(t)})}function M(t,e){try{return JSON.parse(V[e])}catch(t){}return V[e]}function $(t,e,n,r){n&&!0===t.options.template&&(n=G(n,{$pathVariable:t.pathVariable,$params:e.params||{},$body:e.body||{}})),n&&void 0!==n.body&&void 0!==n.status?(n.headers=P({},t.options.headers,n.headers),P(this,n)):(this.status=r,this.body=n,this.headers=P({},t.options.headers))}function R(t,e,n,r){var o=P({},F,r);return k(A(t)?(r=e,t):[{path:t,method:e,response:n}],o,o.baseURL,!0),R}function k(t,e,n,r){A(t)&&a(t,function(t){t.path&&(r&&0===t.path.indexOf("/")?t.path=p()+t.path:r&&/\w+:\/{2}.*/.test(t.path)?t.path=t.path:t.path=n.replace(/\/$/,"")+"/"+t.path.replace(/^\//,""),void 0!==t.response&&(t.method=String(t.method||"GET"),X.push(new O(t.path,t.method,t.response,e))),k(t.children,e,t.path))})}function j(t){var e=(t.getUrl()||"").split(/\?|#/)[0];return X.find(function(n){if((!n.jsonp||n.jsonp===t.jsonp)&&t.method.toLowerCase()===n.method.toLowerCase()){var r=!1,o=[],s=e.match(new RegExp(n.path.replace(/{[^{}]+}/g,function(t){return o.push(t.substring(1,t.length-1)),"([^/]+)"}).replace(/\/[*]{2}/g,"/.+").replace(/\/[*]{1}/g,"/[^/]+")+"/?$"));return n.pathVariable={},r=s&&s.length===o.length+1,n.options.pathVariable&&r&&o.length&&a(o,function(t,e){n.pathVariable[t]=function(t,e){if(t&&"auto"===e.options.pathVariable){if(!isNaN(t))return parseFloat(t);if("true"===t)return!0;if("false"===t)return!1}return t}(s[e+1],n)}),r}})}function O(t,e,n,r){t&&e?(this.path=t,this.method=e,this.time=0,this.response=n,this.options=r,this.asyncTimeout=null):this.options.error&&console.error("path and method cannot be empty")}function H(t){return function(e,n,r){return I(e,t,n,r)}}function L(t){return P(R,t)}var A=Array.isArray||function(t){return!!t&&t.constructor===Array},C=[{rules:[["yyyy",4],["yyy",3],["yy",2]]},{rules:[["MM",2],["M",1]],offset:-1},{rules:[["dd",2],["d",1]]},{rules:[["HH",2],["H",1]]},{rules:[["mm",2],["m",1]]},{rules:[["ss",2],["s",1]]},{rules:[["SSS",3],["SS",2],["S",1]]}],P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])}return t},q={random:{num:o,time:function(t,e,n){return t?e?o(s(t,n).getTime(),s(e,n).getTime()):s(t,n).getTime():t},date:function(t,e,n){return t?i(e?q.random.time(t,e):t,n):t},repeat:function(t,e,n){if(e=e||1,n=n||e,r(t)&&(t=t.split("")),t.length<n){for(var s=t;s.length<n;)s=s.concat(t);s.length=n,t=s}return f(t,o(e,n)).join("")}}},N={tStart:"__restArr=[]",tEnd:"return __restArr.join('');",contStart:"__restArr.push('",contEnd:"');\n",contTrimEnd:"'.trim());\n",cStart:"__restArr.push(",cEnd:");\n",simplifyRegExp:/__restArr\.push\('\s*'\);/g},D=/(.+)\|(array|random)\((.+)\)$/;g.mixin=b,b(q),P(_.prototype,{timeout:0,status:0,readyState:0,ontimeout:null,onreadystatechange:null,withCredentials:!1,response:"",responseText:"",open:function(t,e){this._mock=j(this._request),this._mock?(this.readyState=1,n(this.onreadystatechange)&&this.onreadystatechange()):(this._xhr=new XMLHttpRequest,this._xhr.open(t,e,!0))},send:function(t){var e=this,n=this._mock,r=this._request;if(n)return n.time=l(n.options.timeout),n.getMockResponse(r).then(function(t){e.readyState=4,e._updateResponse(r,t),e._triggerEvent("readystatechange"),e._triggerEvent("load"),n.outMockLog(r,t)});var o=this._xhr;o.withCredentials=this.withCredentials,o.responseType=this.responseType||"",o.onload=function(){e._triggerEvent("load")},o.onerror=function(){e._triggerEvent("error")},o.onreadystatechange=function(){e.readyState=o.readyState,e._updateResponse(r,{status:o.status,body:o.response}),e._triggerEvent("readystatechange")},o.send(t)},abort:function(){var t=this,e=this._mock,n=this._request;setTimeout(function(){if(e){if(0!==t.readyState){clearTimeout(e.asyncTimeout);var r={status:0,body:""};t._updateResponse(t._request,r),t.readyState=4,t._triggerEvent("timeout"),t.readyState=0,e.outMockLog(n,r)}}else t._xhr&&t._xhr.abort()})},setRequestHeader:function(t,e){this._xhr&&this._xhr.setRequestHeader(t,e)},getAllResponseHeaders:function(){if(this._xhr)return this._xhr.getAllResponseHeaders();var t="",e=this._headers;if(e)for(var n in e)e.hasOwnProperty(n)&&(t+=n+": "+e[n]+"\n");return t},_triggerEvent:function(t){n(this["on"+t])&&this["on"+t]({type:t})},_updateResponse:function(t,e){var n=e.body;this.status=e.status,this._headers=e.headers,this._mock&&(n=e.body&&!r(e.body)?JSON.stringify(e.body):""),"blob"===this.responseType?(this.response=n instanceof Blob?n:new Blob([n]),this.responseText=""):this.responseText=this.response=n}});var U="undefined"==typeof window?this:window,V={};P($.prototype,{require:function(t){return new Promise(function(e,n){if(0===t.indexOf("/")?t=p()+t:/\w+:\/{2}.*/.test(t)||(t=F.baseURL.replace(/\/$/,"")+"/"+t),V[t])e(M(0,t));else{var r=new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(){4===r.readyState&&(r.status<200&&r.status>=300&&F.error&&console.error("This relative module was not found: "+t),V[t]=r.responseText,e(M(0,t)))},r.send()}})}});var X=[],F={baseURL:function(){var t=location.pathname,e=function(t,e){if(n(t.lastIndexOf))return t.lastIndexOf(e);for(var r=t.length-1;r>=0;r--)if(e===t[r])return r;return-1}(t,"/")+1;return p()+(e===t.length?t:t.substring(0,e))}(),template:!1,pathVariable:!0,timeout:"20-400",headers:null,error:!0,log:!1};Object.assign(O.prototype,{getMockResponse:function(t){var e=this;return new Promise(function(r,o){e.asyncTimeout=setTimeout(function(){if(!t.$complete)return n(e.response)?Promise.resolve(e.response(t,new $(e,t,null,200),e)).then(function(n){r(new $(e,t,n,200))}):Promise.resolve(e.response).then(function(n){r(new $(e,t,n,200))}).catch(function(n){o(new $(e,t,n,500))})},e.time)})},outMockLog:function(t,e){var n=t.getUrl();this.options.error&&(e.status<200||e.status>=300)&&console.error(t.method+" "+n+" "+e.status),this.options.log&&(console.info("[XEAjaxMock] URL: "+n+"\nMethod: "+t.method+" => Status: "+(e?e.status:"canceled")+" => Time: "+this.time+"ms"),console.info(e))}});var G=g,I=R,J=H("GET"),B=H("POST"),z=H("PUT"),Y=H("DELETE"),K=H("PATCH"),Q=H("HEAD"),W={template:g,Mock:I,JSONP:function(t,e,n){return I(t,"GET",e,P({jsonp:"callback"},n))},HEAD:Q,GET:J,POST:B,PUT:z,DELETE:Y,PATCH:K};return P(R,{mixin:L,setup:function(t){P(F,t)},install:function(t){t.setup({$fetch:E,$XMLHttpRequest:_,$jsonp:T})},version:"1.6.9",$name:"XEAjaxMock"}),L(W),R});